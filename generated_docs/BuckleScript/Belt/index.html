<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Belt (BuckleScript.Belt)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="..">Up</a> â€“ <a href="../">BuckleScript</a> &#x00BB; Belt</nav><h1>Module <code>Belt</code></h1><p>A stdlib shipped with BuckleScript</p><p>This stdlib is still in <i>beta</i> but we encourage you to try it out and give us feedback.</p><p><b>Motivation</b></p><p>The motivation for creating such library is to provide BuckleScript users a better end-to-end user experience, since the original OCaml stdlib was not written with JS in mind. Below is a list of areas this lib aims to improve:</p><ol><li>Consistency in name convention: camlCase, and arguments order</li><li>Exception thrown functions are all suffixed with <i>Exn</i>, e.g, <i>getExn</i></li><li>Better performance and smaller code size running on JS platform</li></ol><p><b>Name Convention</b></p><p>For higher order functions, it will be suffixed <b>U</b> if it takes uncurried callback.</p><pre><code class="ml">val forEach  : 'a t -&gt; ('a -&gt; unit) -&gt; unit
val forEachU : 'a t -&gt; ('a -&gt; unit [\@bs]) -&gt; unit</code></pre><p>In general, uncurried version will be faster, but it may be less familiar to people who have a background in functional programming.</p><p><b>A special encoding for collection safety</b></p><p>When we create a collection library for a custom data type we need a way to provide a comparator function. Take <i>Set</i> for example, suppose its element type is a pair of ints, it needs a custom <i>compare</i> function that takes two tuples and returns their order. The <i>Set</i> could not just be typed as <code> Set.t (int * int) </code>, its customized <i>compare</i> function needs to manifest itself in the signature, otherwise, if the user creates another customized <i>compare</i> function, the two collection could mix which would result in runtime error.</p><p>The original OCaml stdlib solved the problem using <i>functor</i> which creates a big closure at runtime and makes dead code elimination much harder. We use a phantom type to solve the problem:</p><pre><code class="ml">  module Comparable1 = Belt.Id.MakeComparable(struct
    type t = int * int
    let cmp (a0, a1) (b0, b1) =
      match Pervasives.compare a0 b0 with
      | 0 -&gt; Pervasives.compare a1 b1
      | c -&gt; c
  end)

let mySet1 = Belt.Set.make ~id:(module Comparable1)

module Comparable2 = Belt.Id.MakeComparable(struct
  type t = int * int
  let cmp (a0, a1) (b0, b1) =
    match Pervasives.compare a0 b0 with
    | 0 -&gt; Pervasives.compare a1 b1
    | c -&gt; c
end)

let mySet2 = Belt.Set.make ~id:(module Comparable2)</code></pre><p>Here, the compiler would infer <code>mySet1</code> and <code>mySet2</code> having different type, so e.g. a `merge` operation that tries to merge these two sets will correctly fail.</p><pre><code class="ml">val mySet1 : ((int * int), Comparable1.identity) t
val mySet2 : ((int * int), Comparable2.identity) t</code></pre><p><code>Comparable1.identity</code> and <code>Comparable2.identity</code> are not the same using our encoding scheme.</p><p><b>Collection Hierarchy</b></p><p>In general, we provide a generic collection module, but also create specialized modules for commonly used data type. Take <i>Belt.Set</i> for example, we provide:</p><pre><code class="ml">Belt.Set
Belt.Set.Int
Belt.Set.String</code></pre><p>The specialized modules <i>Belt.Set.Int</i>, <i>Belt.Set.String</i> are in general more efficient.</p><p>Currently, both <i>Belt_Set</i> and <i>Belt.Set</i> are accessible to users for some technical reasons, we <b>strongly recommend</b> users stick to qualified import, <i>Belt.Set</i>, we may hide the internal, <i>i.e</i>, <i>Belt_Set</i> in the future</p></header><dl><dt class="spec module" id="module-Id"><a href="#module-Id" class="anchor"></a><code><span class="keyword">module </span>Id = <a href="../Belt_Id">Belt_Id</a><span class="keyword">;</span></code></dt><dd><p><a href="Id"><code>Belt.Id</code></a></p></dd></dl><dl><dt class="spec module" id="module-Array"><a href="#module-Array" class="anchor"></a><code><span class="keyword">module </span>Array = <a href="../Belt_Array">Belt_Array</a><span class="keyword">;</span></code></dt><dd><p><a href="Array"><code>Belt.Array</code></a></p></dd></dl><dl><dt class="spec module" id="module-SortArray"><a href="#module-SortArray" class="anchor"></a><code><span class="keyword">module </span>SortArray = Belt_SortArray<span class="keyword">;</span></code></dt><dd><p><a href="SortArray"><code>Belt.SortArray</code></a></p></dd></dl><dl><dt class="spec module" id="module-MutableQueue"><a href="#module-MutableQueue" class="anchor"></a><code><span class="keyword">module </span>MutableQueue = <a href="../Belt_MutableQueue">Belt_MutableQueue</a><span class="keyword">;</span></code></dt><dd><p><a href="MutableQueue"><code>Belt.MutableQueue</code></a></p></dd></dl><dl><dt class="spec module" id="module-MutableStack"><a href="#module-MutableStack" class="anchor"></a><code><span class="keyword">module </span>MutableStack = <a href="../Belt_MutableStack">Belt_MutableStack</a><span class="keyword">;</span></code></dt><dd><p><a href="MutableStack"><code>Belt.MutableStack</code></a></p></dd></dl><dl><dt class="spec module" id="module-List"><a href="#module-List" class="anchor"></a><code><span class="keyword">module </span>List = <a href="../Belt_List">Belt_List</a><span class="keyword">;</span></code></dt><dd><p><a href="List"><code>Belt.List</code></a></p></dd></dl><dl><dt class="spec module" id="module-Range"><a href="#module-Range" class="anchor"></a><code><span class="keyword">module </span>Range = <a href="../Belt_Range">Belt_Range</a><span class="keyword">;</span></code></dt><dd><p><a href="Range"><code>Belt.Range</code></a></p></dd></dl><dl><dt class="spec module" id="module-Set"><a href="#module-Set" class="anchor"></a><code><span class="keyword">module </span>Set = Belt_Set<span class="keyword">;</span></code></dt><dd><p><a href="Set"><code>Belt.Set</code></a></p></dd></dl><dl><dt class="spec module" id="module-Map"><a href="#module-Map" class="anchor"></a><code><span class="keyword">module </span>Map = Belt_Map<span class="keyword">;</span></code></dt><dd><p><a href="Map"><code>Belt.Map</code></a>,</p></dd></dl><dl><dt class="spec module" id="module-MutableSet"><a href="#module-MutableSet" class="anchor"></a><code><span class="keyword">module </span>MutableSet = Belt_MutableSet<span class="keyword">;</span></code></dt><dd><p><a href="MutableSet"><code>Belt.MutableSet</code></a></p></dd></dl><dl><dt class="spec module" id="module-MutableMap"><a href="#module-MutableMap" class="anchor"></a><code><span class="keyword">module </span>MutableMap = Belt_MutableMap<span class="keyword">;</span></code></dt><dd><p><a href="MutableMap"><code>Belt.MutableMap</code></a></p></dd></dl><dl><dt class="spec module" id="module-HashSet"><a href="#module-HashSet" class="anchor"></a><code><span class="keyword">module </span>HashSet = Belt_HashSet<span class="keyword">;</span></code></dt><dd><p><a href="HashSet"><code>Belt.HashSet</code></a></p></dd></dl><dl><dt class="spec module" id="module-HashMap"><a href="#module-HashMap" class="anchor"></a><code><span class="keyword">module </span>HashMap = Belt_HashMap<span class="keyword">;</span></code></dt><dd><p><a href="HashMap"><code>Belt.HashMap</code></a></p></dd></dl><dl><dt class="spec module" id="module-Option"><a href="#module-Option" class="anchor"></a><code><span class="keyword">module </span>Option = <a href="../Belt_Option">Belt_Option</a><span class="keyword">;</span></code></dt><dd><p><a href="Option"><code>Belt.Option</code></a></p></dd></dl><aside><p><a href="Result"><code>Belt.Result</code></a></p><p>Utilities for result data type.</p></aside><div class="spec module" id="module-Result"><a href="#module-Result" class="anchor"></a><code><span class="keyword">module </span>Result = <a href="../Belt_Result">Belt_Result</a><span class="keyword">;</span></code></div><dl><dt class="spec module" id="module-Debug"><a href="#module-Debug" class="anchor"></a><code><span class="keyword">module </span>Debug = <a href="../Belt_Debug">Belt_Debug</a><span class="keyword">;</span></code></dt><dd><p><a href="Debug"><code>Belt.Debug</code></a></p></dd></dl></div></body></html>